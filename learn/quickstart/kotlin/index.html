<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-learn/quickstart/kotlin">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Kotlin | xef.ai</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://xef.ai/img/social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://xef.ai/img/social-card.jpg"><meta data-rh="true" property="og:url" content="https://xef.ai/learn/quickstart/kotlin/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Kotlin | xef.ai"><meta data-rh="true" name="description" content="Get xef.ai up and running in Kotlin"><meta data-rh="true" property="og:description" content="Get xef.ai up and running in Kotlin"><link data-rh="true" rel="icon" href="/img/xef-brand-icon.svg"><link data-rh="true" rel="canonical" href="https://xef.ai/learn/quickstart/kotlin/"><link data-rh="true" rel="alternate" href="https://xef.ai/learn/quickstart/kotlin/" hreflang="en"><link data-rh="true" rel="alternate" href="https://xef.ai/learn/quickstart/kotlin/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/community/blog/rss.xml" title="xef.ai RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/community/blog/atom.xml" title="xef.ai Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CXGGXNMKQ9"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-CXGGXNMKQ9",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.5be27734.css">
<link rel="preload" href="/assets/js/runtime~main.0dc2e71e.js" as="script">
<link rel="preload" href="/assets/js/main.84c43632.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/xef-brand.svg" alt="xef Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/xef-brand.svg" alt="xef Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/">Home</a><a class="navbar__item navbar__link" href="/learn/overview/">Overview</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/learn/quickstart/">Quickstart</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/learn/quickstart/kotlin/">Kotlin</a></li><li><a class="dropdown__link" href="/learn/quickstart/scala/">Scala</a></li><li><a class="dropdown__link" href="/learn/quickstart/java/">Java</a></li><li><a class="dropdown__link" href="/learn/examples/">Examples</a></li></ul></div><a href="https://github.com/xebia-functional/xef" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/learn/overview/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/learn/quickstart/">Quickstart</a><button aria-label="Toggle the collapsible sidebar category &#x27;Quickstart&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/learn/quickstart/kotlin/">Kotlin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/learn/quickstart/scala/">Scala</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/learn/quickstart/java/">Java</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/learn/examples/">More examples</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1><img class="icon_XZDI" src="/img/kotlin-icon.svg" alt="Icon" title="Icon" width="64px" height="64px">Quickstart - Kotlin</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-the-libraries">Getting the libraries<a href="#getting-the-libraries" class="hash-link" aria-label="Direct link to Getting the libraries" title="Direct link to Getting the libraries">â€‹</a></h2><p>Libraries are published in Maven Central. You may need to  add that repository explicitly
in your build, if you haven&#x27;t done it before. Then add the library in the usual way.</p><div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:linear-gradient(62.54deg, #000 9.29%, var(--ifm-background-color) 91.64%);--prism-color:var(--ifm-color-content)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain">repositories </span><span class="token punctuation" style="color:#ccc">{</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain">    </span><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">mavenCentral</span><span class="token punctuation" style="color:#ccc">(</span><span class="token punctuation" style="color:#ccc">)</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain"></span><span class="token punctuation" style="color:#ccc">}</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain">dependencies </span><span class="token punctuation" style="color:#ccc">{</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain">    </span><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">implementation</span><span class="token punctuation" style="color:#ccc">(</span><span class="token string-literal singleline string" style="color:var(--xef-color-secondary-dark)">&quot;com.xebia:xef-core:&lt;version&gt;&quot;</span><span class="token punctuation" style="color:#ccc">)</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain"></span><span class="token punctuation" style="color:#ccc">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We publish all libraries at once under the same version, so
<a href="https://docs.gradle.org/current/userguide/platforms.html#sec:sharing-catalogs" target="_blank" rel="noopener noreferrer">version catalogs</a>
could be useful.</p><p>By default, the <code>ai</code> block connects to <a href="https://platform.openai.com/" target="_blank" rel="noopener noreferrer">OpenAI</a>.
To use their services you should provide the corresponding API key in the <code>OPENAI_TOKEN</code>
environment variable, and have enough credits.</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Gradle</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">IntelliJ</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:linear-gradient(62.54deg, #000 9.29%, var(--ifm-background-color) 91.64%);--prism-color:var(--ifm-color-content)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">env</span><span class="token plain"> </span><span class="token assign-left variable" style="color:var(--xef-color-secondary-dark)">OPENAI_TOKEN</span><span class="token operator" style="color:#ffb488">=</span><span class="token operator" style="color:#ffb488">&lt;</span><span class="token plain">your-token</span><span class="token operator" style="color:#ffb488">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#ffb488">&lt;</span><span class="token plain">gradle-command</span><span class="token operator" style="color:#ffb488">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>Set the environment variable <code>OPENAI_TOKEN=xxx</code> in the properties.</p></div></div></div><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="m12 1.5-11 21h22l-11-21ZM11 16v-6h2v6h-2Zm0 2v2h2v-2h-2Z" fill="currentColor"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>This library may transmit source code and potentially user input data to third-party services as part of its functionality.
Developers integrating this library into their applications should be aware of this behavior and take necessary precautions to ensure that sensitive data is not inadvertently transmitted.
Read our <a href="https://github.com/xebia-functional/xef#%EF%B8%8F-data-transmission-disclosure" target="_blank" rel="noopener noreferrer"><em>Data Transmission Disclosure</em></a> for further information.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="your-first-prompt">Your first prompt<a href="#your-first-prompt" class="hash-link" aria-label="Direct link to Your first prompt" title="Direct link to Your first prompt">â€‹</a></h2><p>After adding the library to your project
you get access to the <code>ai</code> function, which is your port of entry to the modern AI world.
Inside of it, you can <em>prompt</em> for information, which means posing the question to an LLM
(Large Language Model). The easiest way is to just get the information back as a string.</p><div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:linear-gradient(62.54deg, #000 9.29%, var(--ifm-background-color) 91.64%);--prism-color:var(--ifm-color-content)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">import</span><span class="token plain"> com</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">xebia</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">functional</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">xef</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">auto</span><span class="token punctuation" style="color:#ccc">.</span><span class="token operator" style="color:#ffb488">*</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain"></span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">fun</span><span class="token plain"> </span><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">books</span><span class="token punctuation" style="color:#ccc">(</span><span class="token plain">topic</span><span class="token operator" style="color:#ffb488">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:#ccc">)</span><span class="token operator" style="color:#ffb488">:</span><span class="token plain"> List</span><span class="token operator" style="color:#ffb488">&lt;</span><span class="token plain">String</span><span class="token operator" style="color:#ffb488">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#ffb488">=</span><span class="token plain"> ai </span><span class="token punctuation" style="color:#ccc">{</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain">    </span><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">promptMessage</span><span class="token punctuation" style="color:#ccc">(</span><span class="token string-literal singleline string" style="color:var(--xef-color-secondary-dark)">&quot;Give me a selection of books about </span><span class="token string-literal singleline interpolation interpolation-punctuation punctuation" style="color:#ccc">$</span><span class="token string-literal singleline interpolation expression">topic</span><span class="token string-literal singleline string" style="color:var(--xef-color-secondary-dark)">&quot;</span><span class="token punctuation" style="color:#ccc">)</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain"></span><span class="token punctuation" style="color:#ccc">}</span><span class="token punctuation" style="color:#ccc">.</span><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">getOrThrow</span><span class="token punctuation" style="color:#ccc">(</span><span class="token punctuation" style="color:#ccc">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In the example above we <em>execute</em> the <code>ai</code> block with <code>getOrThrow</code>, that throws an exception
whenever a problem is found (for example, if your API key is not correct). If you want more
control, you can use <code>getOrElse</code> (to which you provide a custom handler for errors), or
<code>toEither</code> (which returns the result using
<a href="https://arrow-kt.io/learn/typed-errors/either-and-ior/" target="_blank" rel="noopener noreferrer"><code>Either</code> from Arrow</a>).</p><p>In the next examples we&#x27;ll write functions that rely on <code>ai</code>&#x27;s DSL functionality,
but without actually extracting the values yet using <code>getOrThrow</code> or <code>getOrElse</code>.
We&#x27;ll eventually call this functions from an <code>ai</code> block as we&#x27;ve shown above, and
this allows us to build larger pipelines, and only extract the final result at the end.</p><p>This can be done by either writing an extension function on <code>AIScope</code>,
or by using the form <code>AI&lt;Something&gt;</code>. Let&#x27;s compare the two:</p><div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:linear-gradient(62.54deg, #000 9.29%, var(--ifm-background-color) 91.64%);--prism-color:var(--ifm-color-content)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">import</span><span class="token plain"> com</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">xebia</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">functional</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">xef</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">auto</span><span class="token punctuation" style="color:#ccc">.</span><span class="token operator" style="color:#ffb488">*</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain"></span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">suspend</span><span class="token plain"> </span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">fun</span><span class="token plain"> AIScope</span><span class="token punctuation" style="color:#ccc">.</span><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">books</span><span class="token punctuation" style="color:#ccc">(</span><span class="token plain">topic</span><span class="token operator" style="color:#ffb488">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:#ccc">)</span><span class="token operator" style="color:#ffb488">:</span><span class="token plain"> String </span><span class="token operator" style="color:#ffb488">=</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain">  </span><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">promptMessage</span><span class="token punctuation" style="color:#ccc">(</span><span class="token string-literal singleline string" style="color:var(--xef-color-secondary-dark)">&quot;Give me a selection of books about </span><span class="token string-literal singleline interpolation interpolation-punctuation punctuation" style="color:#ccc">$</span><span class="token string-literal singleline interpolation expression">topic</span><span class="token string-literal singleline string" style="color:var(--xef-color-secondary-dark)">&quot;</span><span class="token punctuation" style="color:#ccc">)</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain"></span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">fun</span><span class="token plain"> </span><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">books2</span><span class="token punctuation" style="color:#ccc">(</span><span class="token plain">topic</span><span class="token operator" style="color:#ffb488">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:#ccc">)</span><span class="token operator" style="color:#ffb488">:</span><span class="token plain"> AI</span><span class="token operator" style="color:#ffb488">&lt;</span><span class="token plain">String</span><span class="token operator" style="color:#ffb488">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#ffb488">=</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain">  </span><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">promptMessage</span><span class="token punctuation" style="color:#ccc">(</span><span class="token string-literal singleline string" style="color:var(--xef-color-secondary-dark)">&quot;Give me a selection of books about </span><span class="token string-literal singleline interpolation interpolation-punctuation punctuation" style="color:#ccc">$</span><span class="token string-literal singleline interpolation expression">topic</span><span class="token string-literal singleline string" style="color:var(--xef-color-secondary-dark)">&quot;</span><span class="token punctuation" style="color:#ccc">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Both functions are equivalent, but the first is considered most idiomatic, and can be compared to
<code>CoroutineScope</code> from KotlinX Coroutines which gives access to concurrency primitives like <code>launch</code> and <code>async</code>.
The second form is useful when you want to create an extension function on something else than <code>AIScope</code>,
and you can use <code>bind</code> to extract the <code>String</code> value from <code>AI&lt;String&gt;</code> within an <code>ai</code> block or an <code>AIScope</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="structure">Structure<a href="#structure" class="hash-link" aria-label="Direct link to Structure" title="Direct link to Structure">â€‹</a></h2><p>The output from the <code>books</code> function above may be hard to parse back from the
strings we obtain. Fortunately, you can also ask xef.ai to give you back the information
using a <em>custom type</em>. The library takes care of instructing the LLM on building such
a structure, and deserialize the result back for you.</p><div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:linear-gradient(62.54deg, #000 9.29%, var(--ifm-background-color) 91.64%);--prism-color:var(--ifm-color-content)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">import</span><span class="token plain"> com</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">xebia</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">functional</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">xef</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">auto</span><span class="token punctuation" style="color:#ccc">.</span><span class="token operator" style="color:#ffb488">*</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain"></span><span class="token annotation builtin" style="color:var(--xef-color-primary-lightest);text-shadow:0 0 2px #000, 0 0 10px var(--xef-color-secondary-dark), 0 0 5px var(--xef-color-secondary-dark), 0 0 16px var(--xef-color-secondary-dark)">@Serializable</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain"></span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">data</span><span class="token plain"> </span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">class</span><span class="token plain"> </span><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">Book</span><span class="token punctuation" style="color:#ccc">(</span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">val</span><span class="token plain"> title</span><span class="token operator" style="color:#ffb488">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:#ccc">,</span><span class="token plain"> </span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">val</span><span class="token plain"> author</span><span class="token operator" style="color:#ffb488">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:#ccc">)</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain"></span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">suspend</span><span class="token plain"> </span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">fun</span><span class="token plain"> AIScope</span><span class="token punctuation" style="color:#ccc">.</span><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">books</span><span class="token punctuation" style="color:#ccc">(</span><span class="token plain">topic</span><span class="token operator" style="color:#ffb488">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:#ccc">)</span><span class="token operator" style="color:#ffb488">:</span><span class="token plain"> AI</span><span class="token operator" style="color:#ffb488">&lt;</span><span class="token plain">List</span><span class="token operator" style="color:#ffb488">&lt;</span><span class="token plain">Book</span><span class="token operator" style="color:#ffb488">&gt;</span><span class="token operator" style="color:#ffb488">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#ffb488">=</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain">    </span><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">prompt</span><span class="token punctuation" style="color:#ccc">(</span><span class="token string-literal singleline string" style="color:var(--xef-color-secondary-dark)">&quot;Give me a selection of books about </span><span class="token string-literal singleline interpolation interpolation-punctuation punctuation" style="color:#ccc">$</span><span class="token string-literal singleline interpolation expression">topic</span><span class="token string-literal singleline string" style="color:var(--xef-color-secondary-dark)">&quot;</span><span class="token punctuation" style="color:#ccc">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>xef.ai reuses <a href="https://kotlinlang.org/docs/serialization.html" target="_blank" rel="noopener noreferrer">Kotlin&#x27;s common serialization</a>,
which requires adding the <code>kotlinx.serialization</code> plug-in to your build, and mark each
class as <code>@Serializable</code>. The LLM is usually able to detect which kind of information should
go on each field based on its name (like <code>title</code> and <code>author</code> above).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="prompt-templates">Prompt templates<a href="#prompt-templates" class="hash-link" aria-label="Direct link to Prompt templates" title="Direct link to Prompt templates">â€‹</a></h2><p>The function <code>books</code> uses naive string interpolation to make the topic part of the question
to the LLM. As the prompt gets bigger, though, you may want to break it into smaller parts.
The <code>buildPrompt</code> function is the tool here: inside of it you can include any string or
smaller prompt by prefixing it with <code>+</code>
(this is known as the <a href="https://kotlinlang.org/docs/type-safe-builders.html" target="_blank" rel="noopener noreferrer">builder pattern</a>).</p><div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:linear-gradient(62.54deg, #000 9.29%, var(--ifm-background-color) 91.64%);--prism-color:var(--ifm-color-content)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">import</span><span class="token plain"> com</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">xebia</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">functional</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">xef</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">auto</span><span class="token punctuation" style="color:#ccc">.</span><span class="token operator" style="color:#ffb488">*</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain"></span><span class="token annotation builtin" style="color:var(--xef-color-primary-lightest);text-shadow:0 0 2px #000, 0 0 10px var(--xef-color-secondary-dark), 0 0 5px var(--xef-color-secondary-dark), 0 0 16px var(--xef-color-secondary-dark)">@Serializable</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain"></span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">data</span><span class="token plain"> </span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">class</span><span class="token plain"> </span><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">Book</span><span class="token punctuation" style="color:#ccc">(</span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">val</span><span class="token plain"> title</span><span class="token operator" style="color:#ffb488">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:#ccc">,</span><span class="token plain"> </span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">val</span><span class="token plain"> author</span><span class="token operator" style="color:#ffb488">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:#ccc">)</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain"></span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">suspend</span><span class="token plain"> </span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">fun</span><span class="token plain"> AIScope</span><span class="token punctuation" style="color:#ccc">.</span><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">books</span><span class="token punctuation" style="color:#ccc">(</span><span class="token plain">topic</span><span class="token operator" style="color:#ffb488">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:#ccc">)</span><span class="token operator" style="color:#ffb488">:</span><span class="token plain"> List</span><span class="token operator" style="color:#ffb488">&lt;</span><span class="token plain">Book</span><span class="token operator" style="color:#ffb488">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#ccc">{</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain">  </span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">val</span><span class="token plain"> prompt </span><span class="token operator" style="color:#ffb488">=</span><span class="token plain"> buildPrompt </span><span class="token punctuation" style="color:#ccc">{</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain">    </span><span class="token operator" style="color:#ffb488">+</span><span class="token plain"> </span><span class="token string-literal singleline string" style="color:var(--xef-color-secondary-dark)">&quot;Give me a selection of books about the following topic:&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain">    </span><span class="token operator" style="color:#ffb488">+</span><span class="token plain"> topic</span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain">  </span><span class="token punctuation" style="color:#ccc">}</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain">  </span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">return</span><span class="token plain"> </span><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">prompt</span><span class="token punctuation" style="color:#ccc">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:#ccc">)</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain"></span><span class="token punctuation" style="color:#ccc">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In a larger AI application it&#x27;s common to end up with quite some template for prompts.
Online material like <a href="https://www.deeplearning.ai/short-courses/chatgpt-prompt-engineering-for-developers/" target="_blank" rel="noopener noreferrer">this course</a>
and <a href="https://learnprompting.org/docs/intro" target="_blank" rel="noopener noreferrer">this tutorial</a> explain some of the most important patterns,
some of them readily available in xef.ai.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="context">Context<a href="#context" class="hash-link" aria-label="Direct link to Context" title="Direct link to Context">â€‹</a></h2><p>LLMs have knowledge about a broad variety of topics. But by construction they are not able
to respond to questions about information not available in their training set. However, you
often want to supplement the LLM with more data:</p><ul><li>Transient information referring to the current moment, like the current weather, or
the trends in the stock market in the past 10 days.</li><li>Non-public information, for example for summarizing a piece of text you&#x27;re creating
within you organization.</li></ul><p>These additional pieces of information are called the <em>context</em> in xef.ai, and are attached
to every question to the LLM. Although you can add arbitrary strings to the context at any
point, the most common mode of usage is using an <em>agent</em> to consult an external service,
and make its response part of the context. One such agent is <code>search</code>, which uses a web
search service to enrich that context.</p><div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:linear-gradient(62.54deg, #000 9.29%, var(--ifm-background-color) 91.64%);--prism-color:var(--ifm-color-content)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">import</span><span class="token plain"> com</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">xebia</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">functional</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">xef</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">auto</span><span class="token punctuation" style="color:#ccc">.</span><span class="token operator" style="color:#ffb488">*</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain"></span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">suspend</span><span class="token plain"> </span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">fun</span><span class="token plain"> AIScope</span><span class="token punctuation" style="color:#ccc">.</span><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">whatToWear</span><span class="token punctuation" style="color:#ccc">(</span><span class="token plain">place</span><span class="token operator" style="color:#ffb488">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:#ccc">)</span><span class="token operator" style="color:#ffb488">:</span><span class="token plain"> List</span><span class="token operator" style="color:#ffb488">&lt;</span><span class="token plain">String</span><span class="token operator" style="color:#ffb488">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#ffb488">=</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain">  </span><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">context</span><span class="token punctuation" style="color:#ccc">(</span><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">search</span><span class="token punctuation" style="color:#ccc">(</span><span class="token string-literal singleline string" style="color:var(--xef-color-secondary-dark)">&quot;Weather in </span><span class="token string-literal singleline interpolation interpolation-punctuation punctuation" style="color:#ccc">$</span><span class="token string-literal singleline interpolation expression">place</span><span class="token string-literal singleline string" style="color:var(--xef-color-secondary-dark)">&quot;</span><span class="token punctuation" style="color:#ccc">)</span><span class="token punctuation" style="color:#ccc">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#ccc">{</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain">    </span><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">promptMessage</span><span class="token punctuation" style="color:#ccc">(</span><span class="token string-literal singleline string" style="color:var(--xef-color-secondary-dark)">&quot;Knowing this forecast, what clothes do you recommend I should wear?&quot;</span><span class="token punctuation" style="color:#ccc">)</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain">  </span><span class="token punctuation" style="color:#ccc">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 12c0 6.075 4.925 11 11 11s11-4.925 11-11S18.075 1 12 1 1 5.925 1 12Zm8.793-4.293L14.086 12l-4.293 4.293 1.414 1.414 5-5 .707-.707-.707-.707-5-5-1.414 1.414Z" fill="currentColor"></path></svg></span>Better vector stores</div><div class="admonitionContent_S0QG"><p>The underlying mechanism of the context is a <em>vector store</em>, a data structure which
saves a set of strings, and is able to find those similar to another given one.
By default xef.ai uses an <em>in-memory</em> vector store, since it provides maximum
compatibility across platforms. However, if you foresee your context growing above
the hundreds of elements, you may consider switching to another alternative, like
Lucene or PostgreSQL.</p><div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:linear-gradient(62.54deg, #000 9.29%, var(--ifm-background-color) 91.64%);--prism-color:var(--ifm-color-content)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">import</span><span class="token plain"> com</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">xebia</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">functional</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">xef</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">auto</span><span class="token punctuation" style="color:#ccc">.</span><span class="token operator" style="color:#ffb488">*</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain"></span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">import</span><span class="token plain"> com</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">xebia</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">functional</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">xef</span><span class="token punctuation" style="color:#ccc">.</span><span class="token plain">vectorstores</span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain"></span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">suspend</span><span class="token plain"> </span><span class="token keyword" style="color:var(--ifm-color-primary-lightest);text-shadow:0 0 2px #393a33, 0 0 8px var(--xef-color-secondary-dark), 0 0 2px var(--xef-color-secondary-dark)">fun</span><span class="token plain"> AIScope</span><span class="token punctuation" style="color:#ccc">.</span><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">books</span><span class="token punctuation" style="color:#ccc">(</span><span class="token plain">topic</span><span class="token operator" style="color:#ffb488">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:#ccc">)</span><span class="token operator" style="color:#ffb488">:</span><span class="token plain"> List</span><span class="token operator" style="color:#ffb488">&lt;</span><span class="token plain">Book</span><span class="token operator" style="color:#ffb488">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#ffb488">=</span><span class="token plain"></span><br></span><span class="token-line" style="background:#2a2139;background-image:#34294f;color:var(--ifm-color-content);text-shadow:0 0 2px #100c0f, 0 0 5px var(--ifm-color-primary-darkest), 0 0 10px #fff3"><span class="token plain">  </span><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">withContextStore</span><span class="token punctuation" style="color:#ccc">(</span><span class="token function" style="color:var(--xef-color-secondary);text-shadow:0 0 2px #001716, 0 0 1px var(--ifm-color-primary-darkest), 0 0 1px var(--ifm-color-primary-darker), 0 0 3px var(--ifm-color-primary)">InMemoryLuceneBuilder</span><span class="token punctuation" style="color:#ccc">(</span><span class="token plain">LUCENE_PATH</span><span class="token punctuation" style="color:#ccc">)</span><span class="token punctuation" style="color:#ccc">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#ccc">{</span><span class="token plain"> </span><span class="token comment" style="color:#495495;font-style:italic">/* do stuff */</span><span class="token plain"> </span><span class="token punctuation" style="color:#ccc">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/xebia-functional/xef-website/edit/main/content/docs/learn/quickstart/kotlin.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/learn/quickstart/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Quickstart</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/learn/quickstart/scala/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Scala</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#getting-the-libraries" class="table-of-contents__link toc-highlight">Getting the libraries</a></li><li><a href="#your-first-prompt" class="table-of-contents__link toc-highlight">Your first prompt</a></li><li><a href="#structure" class="table-of-contents__link toc-highlight">Structure</a></li><li><a href="#prompt-templates" class="table-of-contents__link toc-highlight">Prompt templates</a></li><li><a href="#context" class="table-of-contents__link toc-highlight">Context</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid container_y1z5"><div><div class="margin-bottom--sm logo_cbK_"><a href="https://xef.ai" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/img/xef-brand.svg" alt="xef Logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo" width="128" height="42"><img src="/img/xef-brand.svg" alt="xef Logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo" width="128" height="42"></a></div><small><div class="footer__copyright">xef is designed and developed by xef with support from <a href="https://xebia.com/" target="_blank" rel="noopener noreferrer">Xebia Functional</a></div></small></div><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Menu</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/learn/overview/">Overview</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/quickstart/">Quickstart</a></li></ul></div><div class="col footer__col"><div class="footer__title">Quickstart</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/learn/quickstart/kotlin/">Kotlin</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/quickstart/scala/">Scala</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/examples/">Examples</a></li></ul></div></div><ul class="clean-list container_dM9r"><li><a href="https://twitter.com/xef_ai" target="_blank" rel="noopener noreferrer"><img src="/img/icon-social-twitter.svg" alt="Twitter" title="Twitter" height="24px" width="24px"></a></li><li><a href="https://www.youtube.com/@xebiafunctional" target="_blank" rel="noopener noreferrer"><img src="/img/icon-social-youtube.svg" alt="YouTube" title="YouTube" height="24px" width="24px"></a></li><li><a href="https://github.com/xebia-functional/xef" target="_blank" rel="noopener noreferrer"><img src="/img/icon-social-github.svg" alt="GitHub" title="GitHub" height="24px" width="24px"></a></li><li><a href="https://stackoverflow.com/questions/tagged/xef" target="_blank" rel="noopener noreferrer"><img src="/img/icon-social-stackoverflow.svg" alt="Stack Overflow" title="Stack Overflow" height="24px" width="24px"></a></li><div class="starsContainer_WEfU"><div>Loading...</div></div></ul></div></footer></div>
<script src="/assets/js/runtime~main.0dc2e71e.js"></script>
<script src="/assets/js/main.84c43632.js"></script>
</body>
</html>